---
title: 饥荒云服搭搭建
date: 2020-01-29 13:40:14
tags: 
    - reference
    - 随笔
    - 游戏指令
categories: 新手指北
id: DSTServerConstruction
---
　　主要介绍基于32位的ubuntu饥荒服务器的搭建以及维护。  
<!--more-->
# 1. 云服务器购买  
　　记下登录名（默认阿里云root，腾讯云ubuntu）与密码，以及公网IP  
# 2. 准备工作
## 2.1 user token
　　用户令牌，这里开启游戏后在steam内找到服务器相关选项并生成即可  
## 2.2 文件上传
### 2.2.1 脚本及工具下载  
　　首先进入链接下载swap.sh以及go.sh两个文件，另外的压缩包为不稳定的云服工具  
　　- [脚本下载百度云链接](https://pan.baidu.com/s/18XbCDXuqvWX-aEu2S7AvfQ)    提取码：5tv7  

　　- [SSH客户端PuTTY](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html )  WIN10 1803以上可直接用CDM  
　　- [SCPGui客户端WinSCP](https://winscp.net/eng/download.php)  用来传文件
### 2.2.2 文件上传
　　安装打开后输入公网IP以及用户名密码即可连接。  
　　-注意这里PuTTY需要设置Windows/selection/勾选Windows(Middle extends, Right brings up menu)以激活右键复制功能，此外PuTTY登录密码会默认隐藏，输入时不可见（一开始以为卡了）  
　　利用WinSCP直接拖拽文件即可进行传输，右下角可设置隐藏文件的显示  
　　- 首先将本地下载的go.sh以及swap.sh拖拽至云端/root/目录下，使用PuTTY输入ls查看当前目录下文件  
　　下面利用PuTTY配置：  
　　- 输入chmod 777 go.sh swap.sh 为脚本提升执行权限  
　　- 输入./swap.sh 开启交换分区（云服超过2G忽略此步骤）  
　　- 输入./go.sh 开始下载steam以及DST  
### 2.2.3 服务器验证
　　下载完毕后输入1进行验证（更新服务器），更新完毕后Ctrl+C退出脚本  
# 3. 服务器使用
## 3.1 开/关服
- 打开PuTTY成功连接对应服务器后输入./go.sh  
- 输入2（启动服务器）（“代码” == 存档文件夹名称）  
- 设定完毕后输入2.1记下的令牌（注意禁用Ctrl+V，请使用右键粘贴）  
- 此后顺次开启地上地下，当出现Sim paused说明地上生成开启，同时按下Ctrl+A+D将地上进程放入后台  
- 同理出现Sim paused说明地下生成开启，同时按下Ctrl+A+D将地下进程放入后台  
- 此时服务器开启成功  

- 同样PuTTY输入./go.sh选择3  
- Caves为地下进程，Master为地上进程。前面的数字ID是两进程的ID，这里输入对应的ID即可进入相应的进程的控制台，以此照葫芦画瓢Ctrl+C终止进程即可  
- 此时服务器关闭成功  
# 4. 维护管理
## 4.1 黑/白/管理名单
- 开启隐藏文件显示后，找到云服务存档目录（/root/.klei/DoNotStarveTogether/存档名）  
- 新建UTF-8编码的blocklist.txt以及whitelist.txt以及adminlist.txt即可，在各自文档内输入用户steam的ID（每行对应一名）  
## 4.2 修改存档/MOD设置
- 首先在游戏内打开一个房间，设置MOD以及存档的相关设定并记录存档位（例如使用第一个存档位后，在本地对应的便为存档文件夹Cluster_1）  
- 生成/更新世界完毕后找到本地存档位置（默认在我的文档/Klei/DoNotStarveTogether/backup），以先前设置的Cluster_1为例，Master为地上，Caves为地下  
各自文件夹内的leveldataoverride.lua为世界设定，Modoverrides.lua为MOD设定。将这两个文件拖入云服中对应位置即可（Master和Caves）  
- 此后找到本地MOD存储位置，使用steam库浏览本地文件可快速到达（D:/steam/steamapps/common/Don't Starve Together/mods）  
将MOD文件夹中对应MOD的文件夹拖拽至云服的对应MOD文件夹中即可（/root/Steam/steamapps/common\Don't Starve Together Dedicated Server/mods）  
- 随后重启服务器即可（先关闭后开启 == 重启）